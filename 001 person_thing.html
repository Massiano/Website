<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>äºº / ä¸œè¥¿</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  background: #1a1a2e;
  color: #eee;
  font-family: system-ui, sans-serif;
  overflow: hidden;
}
#stage {
  position: absolute;
  width: 100%;
  height: 100%;
}
.emoji {
  position: absolute;
  font-size: 120px;
  left: -200px;
  top: 50%;
  transform: translateY(-50%);
  transition: left 1.2s ease-out;
}
.emoji.visible {
  left: 50%;
  transform: translate(-50%, -50%);
}
.emoji.exit {
  left: 120%;
}
#label {
  position: absolute;
  bottom: 120px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 48px;
  opacity: 0;
  transition: opacity 0.5s;
}
#label.show {
  opacity: 1;
}
#quiz {
  position: absolute;
  width: 100%;
  height: 100%;
  display: none;
}
#quiz-emoji {
  position: absolute;
  font-size: 100px;
  top: 30%;
  left: 50%;
  transform: translate(-50%, -50%);
}
#buttons {
  position: absolute;
  top: 60%;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 40px;
}
#buttons button {
  font-size: 32px;
  padding: 20px 50px;
  border: none;
  border-radius: 12px;
  cursor: pointer;
  background: #3a3a5c;
  color: #eee;
}
#buttons button:hover {
  background: #5a5a8c;
}
#progress {
  position: absolute;
  bottom: 40px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 24px;
  color: #888;
}
#feedback {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 80px;
  opacity: 0;
  transition: opacity 0.3s;
  pointer-events: none;
}
</style>
</head>
<body>

<div id="stage">
  <div class="emoji" id="current-emoji"></div>
  <div id="label"></div>
</div>

<div id="quiz">
  <div id="quiz-emoji"></div>
  <div id="buttons">
    <button onclick="answer('person')">äºº</button>
    <button onclick="answer('thing')">ä¸œè¥¿</button>
  </div>
  <div id="progress"></div>
  <div id="feedback"></div>
</div>

<script>
const demoSequence = [
  { emoji: 'ðŸ‘¨â€ðŸ¦°', words: ['äºº?', 'äººã€‚'] },
  { emoji: 'ðŸª‘', words: ['ä¸œè¥¿?', 'ä¸œè¥¿ã€‚'] },
  { emoji: 'ðŸ‘µ', words: ['äºº?', 'äººã€‚'] },
  { emoji: 'ðŸŽ', words: ['ä¸œè¥¿?', 'ä¸œè¥¿ã€‚'] },
  { emoji: 'ðŸª‘', words: ['äºº?', 'ä¸æ˜¯äººã€‚'] },
  { emoji: 'ðŸ±', words: ['ä¸œè¥¿?', 'ä¸æ˜¯ä¸œè¥¿ã€‚'] },
  { emoji: 'ðŸ§’', words: ['äºº?', 'äººã€‚'] },
  { emoji: 'ðŸ“š', words: ['ä¸œè¥¿?', 'ä¸œè¥¿ã€‚'] }
];

const quizEmojis = [
  { emoji: 'ðŸ‘·', type: 'person' },
  { emoji: 'ðŸ”‘', type: 'thing' },
  { emoji: 'ðŸ‘©â€ðŸŽ¤', type: 'person' },
  { emoji: 'ðŸŽ¸', type: 'thing' },
  { emoji: 'ðŸ§“', type: 'person' },
  { emoji: 'ðŸº', type: 'thing' },
  { emoji: 'ðŸ‘¨â€ðŸ³', type: 'person' },
  { emoji: 'ðŸ§²', type: 'thing' }
];

let demoIndex = 0;
let quizIndex = 0;

const emojiEl = document.getElementById('current-emoji');
const labelEl = document.getElementById('label');
const stageEl = document.getElementById('stage');
const quizEl = document.getElementById('quiz');
const quizEmojiEl = document.getElementById('quiz-emoji');
const progressEl = document.getElementById('progress');
const feedbackEl = document.getElementById('feedback');

const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

function speak(text) {
  const u = new SpeechSynthesisUtterance(text);
  u.lang = 'zh-CN';
  u.rate = 0.8;
  speechSynthesis.speak(u);
}

function playTone(freq, duration, type) {
  const osc = audioCtx.createOscillator();
  const gain = audioCtx.createGain();
  osc.type = type || 'sine';
  osc.frequency.value = freq;
  gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
  gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
  osc.connect(gain);
  gain.connect(audioCtx.destination);
  osc.start();
  osc.stop(audioCtx.currentTime + duration);
}

function playNegative() {
  playTone(200, 0.15, 'square');
  setTimeout(() => playTone(150, 0.3, 'square'), 150);
}

function showDemo() {
  if (demoIndex >= demoSequence.length) {
    setTimeout(startQuiz, 1000);
    return;
  }
  
  const item = demoSequence[demoIndex];
  emojiEl.textContent = item.emoji;
  emojiEl.className = 'emoji';
  labelEl.className = '';
  labelEl.textContent = '';
  
  setTimeout(() => {
    emojiEl.classList.add('visible');
  }, 100);
  
  setTimeout(() => {
    labelEl.textContent = item.words[0];
    labelEl.classList.add('show');
    speak(item.words[0]);
  }, 1500);
  
  setTimeout(() => {
    labelEl.textContent = item.words[1];
    speak(item.words[1]);
  }, 3000);
  
  setTimeout(() => {
    emojiEl.classList.remove('visible');
    emojiEl.classList.add('exit');
    labelEl.classList.remove('show');
  }, 5000);
  
  setTimeout(() => {
    demoIndex++;
    showDemo();
  }, 6500);
}

function startQuiz() {
  stageEl.style.display = 'none';
  quizEl.style.display = 'block';
  showQuizItem();
}

function showQuizItem() {
  if (quizIndex >= quizEmojis.length) {
    quizEmojiEl.textContent = 'âœ“';
    document.getElementById('buttons').style.display = 'none';
    progressEl.textContent = 'å®Œæˆ!';
    return;
  }
  
  quizEmojiEl.textContent = quizEmojis[quizIndex].emoji;
  progressEl.textContent = (quizIndex + 1) + ' / ' + quizEmojis.length;
}

function answer(choice) {
  const correct = quizEmojis[quizIndex].type;
  
  if (choice === correct) {
    feedbackEl.textContent = 'âœ“';
    feedbackEl.style.color = '#4f4';
    feedbackEl.style.opacity = 1;
    speak(correct === 'person' ? 'äºº' : 'ä¸œè¥¿');
  } else {
    feedbackEl.textContent = 'âœ—';
    feedbackEl.style.color = '#f44';
    feedbackEl.style.opacity = 1;
    playNegative();
  }
  
  setTimeout(() => {
    feedbackEl.style.opacity = 0;
    quizIndex++;
    showQuizItem();
  }, 1200);
}

document.body.addEventListener('click', function init() {
  audioCtx.resume();
  document.body.removeEventListener('click', init);
}, { once: true });

setTimeout(showDemo, 800);
</script>

</body>
</html>
