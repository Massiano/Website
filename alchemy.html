<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>ÁÇºÈáëÊúØ</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { 
  background: #1a1a2e; 
  color: #eee; 
  font-family: system-ui, sans-serif;
  overflow: hidden;
  user-select: none;
}

#workspace {
  position: absolute;
  top: 0; left: 0; right: 200px; bottom: 0;
  background: #16213e;
}

#sidebar {
  position: absolute;
  top: 0; right: 0; bottom: 0; width: 200px;
  background: #0f3460;
  overflow-y: auto;
  padding: 10px;
}

#sidebar h2 {
  text-align: center;
  margin-bottom: 10px;
  font-size: 16px;
  color: #e94560;
}

#inventory {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
}

.element {
  position: absolute;
  background: #533483;
  border-radius: 8px;
  padding: 8px 12px;
  cursor: grab;
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 20px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.3);
  transition: box-shadow 0.2s;
}

.element:hover {
  box-shadow: 0 4px 16px rgba(233,69,96,0.4);
}

.element.dragging {
  cursor: grabbing;
  z-index: 1000;
  box-shadow: 0 8px 24px rgba(0,0,0,0.5);
}

.element .emoji { font-size: 24px; }
.element .hanzi { font-size: 18px; }

.sidebar-item {
  background: #533483;
  border-radius: 6px;
  padding: 6px 10px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 16px;
}

.sidebar-item:hover {
  background: #e94560;
}

.sidebar-item .emoji { font-size: 20px; }
.sidebar-item .hanzi { font-size: 14px; }

#count {
  position: absolute;
  bottom: 10px;
  left: 10px;
  color: #e94560;
  font-size: 14px;
}

#clear-btn {
  position: absolute;
  bottom: 10px;
  right: 220px;
  background: #e94560;
  border: none;
  color: white;
  padding: 8px 16px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
}

.combine-flash {
  animation: flash 0.3s ease-out;
}

@keyframes flash {
  0% { transform: scale(1.3); background: #e94560; }
  100% { transform: scale(1); }
}

#new-discovery {
  position: absolute;
  top: 50%;
  left: calc(50% - 100px);
  transform: translate(-50%, -50%);
  background: #e94560;
  padding: 20px 40px;
  border-radius: 12px;
  font-size: 32px;
  display: none;
  z-index: 2000;
  animation: popIn 0.4s ease-out;
}

@keyframes popIn {
  0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
  100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
}
</style>
</head>
<body>

<div id="workspace"></div>
<div id="sidebar">
  <h2>ÂÖÉÁ¥†</h2>
  <div id="inventory"></div>
</div>
<div id="count"></div>
<button id="clear-btn">Ê∏ÖÁ©∫</button>
<div id="new-discovery"></div>

<script>
const ELEMENTS = {
  // Âü∫Êú¨ÂõõÂÖÉÁ¥†
  fire: { emoji: 'üî•', hanzi: 'ÁÅ´' },
  water: { emoji: 'üíß', hanzi: 'Ê∞¥' },
  earth: { emoji: 'ü™®', hanzi: 'Âúü' },
  air: { emoji: 'üí®', hanzi: 'È£é' },
  
  // ÂèØÂêàÊàêÂÖÉÁ¥†
  steam: { emoji: '‚ô®Ô∏è', hanzi: 'Ê∞î' },
  mud: { emoji: 'üü§', hanzi: 'Ê≥•' },
  lava: { emoji: 'üåã', hanzi: 'Â≤©' },
  dust: { emoji: 'üå´Ô∏è', hanzi: 'Â∞ò' },
  rain: { emoji: 'üåßÔ∏è', hanzi: 'Èõ®' },
  sea: { emoji: 'üåä', hanzi: 'Êµ∑' },
  mountain: { emoji: '‚õ∞Ô∏è', hanzi: 'Â±±' },
  sun: { emoji: '‚òÄÔ∏è', hanzi: 'Êó•' },
  moon: { emoji: 'üåô', hanzi: 'Êúà' },
  star: { emoji: '‚≠ê', hanzi: 'Êòü' },
  cloud: { emoji: '‚òÅÔ∏è', hanzi: '‰∫ë' },
  snow: { emoji: '‚ùÑÔ∏è', hanzi: 'Èõ™' },
  ice: { emoji: 'üßä', hanzi: 'ÂÜ∞' },
  plant: { emoji: 'üå±', hanzi: 'Ëçâ' },
  tree: { emoji: 'üå≥', hanzi: 'Êú®' },
  flower: { emoji: 'üå∏', hanzi: 'Ëä±' },
  fruit: { emoji: 'üçé', hanzi: 'Êûú' },
  bird: { emoji: 'üê¶', hanzi: 'È∏ü' },
  fish: { emoji: 'üêü', hanzi: 'È±º' },
  egg: { emoji: 'ü•ö', hanzi: 'Ëõã' },
  stone: { emoji: 'ü™®', hanzi: 'Áü≥' },
  metal: { emoji: 'üî©', hanzi: 'Èáë' },
  sand: { emoji: 'üèñÔ∏è', hanzi: 'Ê≤ô' },
  glass: { emoji: 'ü™ü', hanzi: 'Áéª' },
  fire2: { emoji: 'üî•', hanzi: 'ÁÇé' },
  lake: { emoji: 'üèûÔ∏è', hanzi: 'Êπñ' },
  river: { emoji: 'üèûÔ∏è', hanzi: 'Ê≤≥' },
  wind: { emoji: 'üåÄ', hanzi: 'Êóã' },
  thunder: { emoji: '‚ö°', hanzi: 'Èõ∑' },
  light: { emoji: 'üí°', hanzi: 'ÂÖâ' },
  ash: { emoji: 'ite', hanzi: 'ÁÅ∞' },
  coal: { emoji: '‚ö´', hanzi: 'ÁÇ≠' },
  sky: { emoji: 'üåå', hanzi: 'Â§©' },
  human: { emoji: 'üßë', hanzi: '‰∫∫' },
  house: { emoji: 'üè†', hanzi: 'Â±ã' },
  field: { emoji: 'üåæ', hanzi: 'Áî∞' },
  rice: { emoji: 'üçö', hanzi: 'Á±≥' },
  meat: { emoji: 'üçñ', hanzi: 'ËÇâ' },
  dog: { emoji: 'üêï', hanzi: 'Áãó' },
  cat: { emoji: 'üêà', hanzi: 'Áå´' },
  horse: { emoji: 'üêé', hanzi: 'È©¨' },
  cow: { emoji: 'üêÑ', hanzi: 'Áâõ' },
  pig: { emoji: 'üêñ', hanzi: 'Áå™' },
  sheep: { emoji: 'üêë', hanzi: 'Áæä' },
  dragon: { emoji: 'üêâ', hanzi: 'Èæô' },
  phoenix: { emoji: 'ü¶Ö', hanzi: 'Âá§' },
  sword: { emoji: 'üó°Ô∏è', hanzi: 'Ââë' },
  wheel: { emoji: 'üõû', hanzi: 'ËΩÆ' },
  cart: { emoji: 'üõí', hanzi: 'ËΩ¶' },
  boat: { emoji: 'üö£', hanzi: 'Ëàü' },
  wine: { emoji: 'üç∑', hanzi: 'ÈÖí' },
  salt: { emoji: 'üßÇ', hanzi: 'Áõê' },
  oil: { emoji: 'üõ¢Ô∏è', hanzi: 'Ê≤π' },
  paper: { emoji: 'üìÑ', hanzi: 'Á∫∏' },
  book: { emoji: 'üìñ', hanzi: '‰π¶' },
  ink: { emoji: 'üñ§', hanzi: 'Â¢®' },
  brush: { emoji: 'üñåÔ∏è', hanzi: 'Á¨î' },
  silk: { emoji: 'üß£', hanzi: '‰∏ù' },
  cloth: { emoji: 'üß∂', hanzi: 'Â∏É' },
  needle: { emoji: 'ü™°', hanzi: 'Èíà' },
  pot: { emoji: 'üç≤', hanzi: 'ÈîÖ' },
  tea: { emoji: 'üçµ', hanzi: 'Ëå∂' },
  medicine: { emoji: 'üíä', hanzi: 'ËçØ' },
  ghost: { emoji: 'üëª', hanzi: 'È¨º' },
  god: { emoji: 'üëº', hanzi: 'Á•û' },
  love: { emoji: '‚ù§Ô∏è', hanzi: 'Áà±' },
  life: { emoji: 'üåø', hanzi: 'Áîü' },
  death: { emoji: 'üíÄ', hanzi: 'Ê≠ª' },
  time: { emoji: '‚è∞', hanzi: 'Êó∂' },
  night: { emoji: 'üåÉ', hanzi: 'Â§ú' },
  day: { emoji: 'üåÖ', hanzi: 'Êòº' },
  spring: { emoji: 'üå∑', hanzi: 'Êò•' },
  summer: { emoji: 'üåª', hanzi: 'Â§è' },
  autumn: { emoji: 'üçÇ', hanzi: 'Áßã' },
  winter: { emoji: '‚õÑ', hanzi: 'ÂÜ¨' },
  year: { emoji: 'üìÖ', hanzi: 'Âπ¥' },
};

// ÂêàÊàêÈÖçÊñπ [ÂÖÉÁ¥†1, ÂÖÉÁ¥†2] = ÁªìÊûú
const RECIPES = {
  'fire+water': 'steam',
  'water+fire': 'steam',
  'earth+water': 'mud',
  'water+earth': 'mud',
  'fire+earth': 'lava',
  'earth+fire': 'lava',
  'air+earth': 'dust',
  'earth+air': 'dust',
  'air+water': 'cloud',
  'water+air': 'cloud',
  'fire+air': 'dust',
  'air+fire': 'dust',
  'cloud+water': 'rain',
  'water+cloud': 'rain',
  'water+water': 'sea',
  'earth+earth': 'mountain',
  'fire+fire': 'sun',
  'air+air': 'wind',
  'cloud+cloud': 'rain',
  'rain+earth': 'mud',
  'earth+rain': 'mud',
  'rain+mud': 'plant',
  'mud+rain': 'plant',
  'water+mud': 'plant',
  'mud+water': 'plant',
  'plant+earth': 'tree',
  'earth+plant': 'tree',
  'plant+water': 'flower',
  'water+plant': 'flower',
  'plant+sun': 'tree',
  'sun+plant': 'tree',
  'tree+sun': 'fruit',
  'sun+tree': 'fruit',
  'flower+sun': 'fruit',
  'sun+flower': 'fruit',
  'air+bird': 'egg',
  'bird+air': 'egg',
  'water+fish': 'egg',
  'fish+water': 'egg',
  'lava+water': 'stone',
  'water+lava': 'stone',
  'lava+air': 'stone',
  'air+lava': 'stone',
  'stone+fire': 'metal',
  'fire+stone': 'metal',
  'stone+air': 'sand',
  'air+stone': 'sand',
  'stone+wind': 'sand',
  'wind+stone': 'sand',
  'sand+fire': 'glass',
  'fire+sand': 'glass',
  'sun+fire': 'fire2',
  'fire+sun': 'fire2',
  'rain+mountain': 'river',
  'mountain+rain': 'river',
  'rain+earth': 'lake',
  'rain+rain': 'lake',
  'river+river': 'sea',
  'lake+lake': 'sea',
  'cloud+fire': 'thunder',
  'fire+cloud': 'thunder',
  'rain+thunder': 'thunder',
  'thunder+rain': 'thunder',
  'sun+glass': 'light',
  'glass+sun': 'light',
  'fire+wood': 'ash',
  'wood+fire': 'ash',
  'fire+tree': 'ash',
  'tree+fire': 'ash',
  'fire+tree': 'coal',
  'tree+earth': 'coal',
  'earth+tree': 'coal',
  'air+sun': 'sky',
  'sun+air': 'sky',
  'cloud+sun': 'sky',
  'sun+cloud': 'sky',
  'mud+life': 'human',
  'life+mud': 'human',
  'earth+life': 'human',
  'life+earth': 'human',
  'stone+tree': 'house',
  'tree+stone': 'house',
  'human+earth': 'field',
  'earth+human': 'field',
  'field+water': 'rice',
  'water+field': 'rice',
  'plant+field': 'rice',
  'field+plant': 'rice',
  'egg+air': 'bird',
  'air+egg': 'bird',
  'egg+water': 'fish',
  'water+egg': 'fish',
  'bird+earth': 'dog',
  'earth+bird': 'dog',
  'fish+earth': 'cat',
  'earth+fish': 'cat',
  'human+plant': 'dog',
  'plant+human': 'dog',
  'dog+air': 'horse',
  'air+dog': 'horse',
  'earth+plant': 'cow',
  'plant+earth': 'cow',
  'mud+plant': 'pig',
  'plant+mud': 'pig',
  'cloud+plant': 'sheep',
  'plant+cloud': 'sheep',
  'fire+fish': 'dragon',
  'fish+fire': 'dragon',
  'snake+fire': 'dragon',
  'fire+snake': 'dragon',
  'bird+fire': 'phoenix',
  'fire+bird': 'phoenix',
  'metal+fire': 'sword',
  'fire+metal': 'sword',
  'tree+metal': 'wheel',
  'metal+tree': 'wheel',
  'wheel+tree': 'cart',
  'tree+wheel': 'cart',
  'tree+water': 'boat',
  'water+tree': 'boat',
  'fruit+water': 'wine',
  'water+fruit': 'wine',
  'rice+water': 'wine',
  'water+rice': 'wine',
  'sea+sun': 'salt',
  'sun+sea': 'salt',
  'water+sun': 'salt',
  'plant+fire': 'oil',
  'fire+plant': 'oil',
  'tree+water': 'paper',
  'water+tree': 'paper',
  'paper+paper': 'book',
  'coal+water': 'ink',
  'water+coal': 'ink',
  'ash+water': 'ink',
  'water+ash': 'ink',
  'tree+ink': 'brush',
  'ink+tree': 'brush',
  'plant+water': 'silk',
  'silk+silk': 'cloth',
  'metal+fire': 'needle',
  'fire+metal': 'needle',
  'metal+earth': 'pot',
  'earth+metal': 'pot',
  'plant+water': 'tea',
  'water+plant': 'tea',
  'plant+fire': 'medicine',
  'fire+plant': 'medicine',
  'human+death': 'ghost',
  'death+human': 'ghost',
  'human+sky': 'god',
  'sky+human': 'god',
  'ghost+light': 'god',
  'light+ghost': 'god',
  'human+human': 'love',
  'fire+water': 'life',
  'sun+earth': 'life',
  'earth+sun': 'life',
  'fire+death': 'ash',
  'death+fire': 'ash',
  'time+human': 'death',
  'human+time': 'death',
  'sun+moon': 'time',
  'moon+sun': 'time',
  'sky+sun': 'day',
  'sun+sky': 'day',
  'sky+moon': 'night',
  'moon+sky': 'night',
  'flower+rain': 'spring',
  'rain+flower': 'spring',
  'sun+sun': 'summer',
  'tree+wind': 'autumn',
  'wind+tree': 'autumn',
  'cloud+ice': 'winter',
  'ice+cloud': 'winter',
  'snow+wind': 'winter',
  'wind+snow': 'winter',
  'water+air': 'ice',
  'cold+water': 'ice',
  'cloud+cold': 'snow',
  'rain+cold': 'snow',
  'rain+winter': 'snow',
  'winter+rain': 'snow',
  'water+winter': 'ice',
  'winter+water': 'ice',
  'spring+summer': 'year',
  'summer+autumn': 'year',
  'autumn+winter': 'year',
  'winter+spring': 'year',
  'day+night': 'time',
  'night+day': 'time',
  'star+star': 'moon',
  'sky+night': 'star',
  'night+sky': 'star',
  'light+night': 'star',
  'night+light': 'star',
};

let discovered = new Set(['fire', 'water', 'earth', 'air']);
let workspaceElements = [];
let dragElement = null;
let offsetX = 0, offsetY = 0;

const workspace = document.getElementById('workspace');
const inventory = document.getElementById('inventory');
const countDisplay = document.getElementById('count');
const clearBtn = document.getElementById('clear-btn');
const newDiscovery = document.getElementById('new-discovery');

function speak(text) {
  const utterance = new SpeechSynthesisUtterance(text);
  utterance.lang = 'zh-CN';
  utterance.rate = 0.8;
  speechSynthesis.speak(utterance);
}

function updateCount() {
  countDisplay.textContent = `${discovered.size} / ${Object.keys(ELEMENTS).length}`;
}

function renderInventory() {
  inventory.innerHTML = '';
  const sorted = Array.from(discovered).sort((a, b) => {
    return ELEMENTS[a].hanzi.localeCompare(ELEMENTS[b].hanzi, 'zh');
  });
  
  sorted.forEach(id => {
    const el = ELEMENTS[id];
    const item = document.createElement('div');
    item.className = 'sidebar-item';
    item.innerHTML = `<span class="emoji">${el.emoji}</span><span class="hanzi">${el.hanzi}</span>`;
    item.onclick = () => {
      speak(el.hanzi);
      spawnElement(id, 100 + Math.random() * 200, 100 + Math.random() * 200);
    };
    inventory.appendChild(item);
  });
  updateCount();
}

function spawnElement(id, x, y) {
  const el = ELEMENTS[id];
  const div = document.createElement('div');
  div.className = 'element';
  div.dataset.id = id;
  div.innerHTML = `<span class="emoji">${el.emoji}</span><span class="hanzi">${el.hanzi}</span>`;
  div.style.left = x + 'px';
  div.style.top = y + 'px';
  
  div.onmousedown = startDrag;
  div.ondblclick = () => {
    speak(el.hanzi);
  };
  
  workspace.appendChild(div);
  workspaceElements.push(div);
  return div;
}

function startDrag(e) {
  dragElement = e.currentTarget;
  dragElement.classList.add('dragging');
  const rect = dragElement.getBoundingClientRect();
  const wsRect = workspace.getBoundingClientRect();
  offsetX = e.clientX - rect.left;
  offsetY = e.clientY - rect.top;
  
  document.onmousemove = onDrag;
  document.onmouseup = endDrag;
}

function onDrag(e) {
  if (!dragElement) return;
  const wsRect = workspace.getBoundingClientRect();
  let x = e.clientX - wsRect.left - offsetX;
  let y = e.clientY - wsRect.top - offsetY;
  
  x = Math.max(0, Math.min(x, wsRect.width - dragElement.offsetWidth));
  y = Math.max(0, Math.min(y, wsRect.height - dragElement.offsetHeight));
  
  dragElement.style.left = x + 'px';
  dragElement.style.top = y + 'px';
}

function endDrag(e) {
  if (!dragElement) return;
  dragElement.classList.remove('dragging');
  
  // Ê£ÄÊü•Á¢∞Êíû
  const dragRect = dragElement.getBoundingClientRect();
  
  for (const other of workspaceElements) {
    if (other === dragElement) continue;
    
    const otherRect = other.getBoundingClientRect();
    
    if (dragRect.left < otherRect.right &&
        dragRect.right > otherRect.left &&
        dragRect.top < otherRect.bottom &&
        dragRect.bottom > otherRect.top) {
      
      // Á¢∞ÊíûÔºÅÂ∞ùËØïÂêàÊàê
      const id1 = dragElement.dataset.id;
      const id2 = other.dataset.id;
      const key = `${id1}+${id2}`;
      const result = RECIPES[key];
      
      if (result && ELEMENTS[result]) {
        const newX = (parseFloat(dragElement.style.left) + parseFloat(other.style.left)) / 2;
        const newY = (parseFloat(dragElement.style.top) + parseFloat(other.style.top)) / 2;
        
        // ÁßªÈô§ÊóßÂÖÉÁ¥†
        dragElement.remove();
        other.remove();
        workspaceElements = workspaceElements.filter(el => el !== dragElement && el !== other);
        
        // ÂàõÂª∫Êñ∞ÂÖÉÁ¥†
        const newEl = spawnElement(result, newX, newY);
        newEl.classList.add('combine-flash');
        setTimeout(() => newEl.classList.remove('combine-flash'), 300);
        
        // Êí≠ÊîæÂèëÈü≥
        speak(ELEMENTS[result].hanzi);
        
        // Êñ∞ÂèëÁé∞Ôºü
        if (!discovered.has(result)) {
          discovered.add(result);
          renderInventory();
          showDiscovery(result);
        }
        
        dragElement = null;
        document.onmousemove = null;
        document.onmouseup = null;
        return;
      }
    }
  }
  
  dragElement = null;
  document.onmousemove = null;
  document.onmouseup = null;
}

function showDiscovery(id) {
  const el = ELEMENTS[id];
  newDiscovery.innerHTML = `${el.emoji} ${el.hanzi}`;
  newDiscovery.style.display = 'block';
  setTimeout(() => {
    newDiscovery.style.display = 'none';
  }, 1500);
}

clearBtn.onclick = () => {
  workspaceElements.forEach(el => el.remove());
  workspaceElements = [];
};

// ÂàùÂßãÂåñ
renderInventory();

// ÊîæÁΩÆÂàùÂßãÂÖÉÁ¥†
spawnElement('fire', 100, 100);
spawnElement('water', 200, 100);
spawnElement('earth', 100, 200);
spawnElement('air', 200, 200);
</script>
</body>
</html>
